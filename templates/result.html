<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulation Results</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh; padding: 20px;
    }
    .container {
      max-width: 1200px; margin: 0 auto; background: white;
      border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden;
    }
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; padding: 30px; text-align: center;
    }
    .header h1 { font-size: 28px; margin-bottom: 8px; font-weight: 600; }
    .header p { font-size: 14px; opacity: 0.9; }
    .content { padding: 40px; }
    .section { margin-bottom: 32px; }
    .section-title {
      color: #667eea; font-size: 20px; margin-bottom: 16px;
      padding-bottom: 8px; border-bottom: 2px solid #e0e0e0;
      display: flex; align-items: center; gap: 8px;
    }
    .stats-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px; margin-bottom: 24px;
    }
    .stat-card {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      padding: 20px; border-radius: 12px; text-align: center;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: transform 0.2s;
    }
    .stat-card:hover { transform: translateY(-4px); }
    .stat-card .label {
      font-size: 13px; color: #666; margin-bottom: 8px; font-weight: 600;
    }
    .stat-card .value { font-size: 28px; color: #667eea; font-weight: bold; }
    .stat-card .unit { font-size: 14px; color: #888; }
    .perf-grid {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;
    }
    .perf-item {
      background: #f8f9fa; padding: 16px; border-radius: 8px; border-left: 4px solid #667eea;
    }
    .perf-item .perf-label { font-size: 13px; color: #666; margin-bottom: 4px; }
    .perf-item .perf-value { font-size: 20px; color: #333; font-weight: bold; }
    .perf-item .perf-unit { font-size: 14px; color: #888; }
    .download-section {
      background: #f8f9fa; padding: 24px; border-radius: 12px; margin-bottom: 24px;
    }
    .btn {
      display: inline-block; padding: 12px 24px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; text-decoration: none; border-radius: 8px;
      font-weight: 600; transition: transform 0.2s, box-shadow 0.2s;
      margin-right: 12px; margin-bottom: 12px;
    }
    .btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
    }
    .btn-secondary { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    .plot-container {
      margin-bottom: 24px; background: #f8f9fa;
      padding: 20px; border-radius: 12px;
    }
    .plot-container h4 { font-size: 16px; color: #333; margin-bottom: 12px; }
    .plot-container img {
      width: 100%; border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .params-table {
      width: 100%; border-collapse: collapse; margin-top: 16px;
    }
    .params-table td {
      padding: 10px; border-bottom: 1px solid #e0e0e0;
    }
    .params-table td:first-child {
      font-weight: 600; color: #667eea; width: 40%;
    }
    .params-table td:last-child { color: #333; }
    .back-link {
      text-align: center; margin-top: 32px;
      padding-top: 32px; border-top: 2px solid #e0e0e0;
    }
    .badge {
      display: inline-block; padding: 4px 12px;
      background: #667eea; color: white; border-radius: 12px;
      font-size: 12px; font-weight: 600; margin-left: 8px;
    }
    .info-box {
      background: #e8f4f8; border-left: 4px solid #2196F3;
      padding: 16px; border-radius: 8px; margin-bottom: 24px;
      font-size: 14px; color: #555;
    }
    .warning-box {
      background: #fff3cd; border-left: 4px solid #ffc107;
      padding: 16px; border-radius: 8px; margin-bottom: 24px;
      font-size: 14px; color: #856404;
    }
    .new-badge {
      background: #e74c3c; color: white;
      padding: 2px 8px; border-radius: 4px;
      font-size: 11px; font-weight: bold;
      margin-left: 8px;
    }
    @media (max-width: 768px) {
      .content { padding: 24px; }
      .stats-grid, .perf-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>âœ… Simulasi Berhasil</h1>
      <p>Analisis lengkap dengan 6 comprehensive plots</p>
    </div>
    
    <div class="content">
      
      {% if time_warning %}
      <div class="warning-box">
        <strong>âš ï¸ Warning:</strong> {{ time_warning }}. Consider adjusting speed parameters or traffic density.
      </div>
      {% endif %}
      
      <!-- Trip Overview -->
      <div class="section">
        <h2 class="section-title">ğŸ“Š Ringkasan Perjalanan</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="label">Total Jarak</div>
            <div class="value">{{ perf.total_distance_km }}</div>
            <div class="unit">km</div>
          </div>
          <div class="stat-card">
            <div class="label">Waktu Tempuh</div>
            <div class="value">{{ total_time_min }}</div>
            <div class="unit">menit ({{ total_time_hr }} jam)</div>
          </div>
          <div class="stat-card">
            <div class="label">Kecepatan Rata-rata</div>
            <div class="value">{{ perf.average_speed_kmh }}</div>
            <div class="unit">km/h</div>
          </div>
          <div class="stat-card">
            <div class="label">Kecepatan Maksimal</div>
            <div class="value">{{ perf.max_speed_kmh }}</div>
            <div class="unit">km/h</div>
          </div>
        </div>
        
        <div class="info-box">
          <strong>â„¹ï¸ Informasi:</strong> Data simulasi dengan {{ rows }} data points (per detik). 
          {% if params.target_time_minutes != 'Not set' %}
          Target waktu: <strong>{{ params.target_time_minutes }} menit</strong>, Actual: <strong>{{ total_time_min }} menit</strong>.
          {% endif %}
        </div>
      </div>
      
      <!-- Performance Metrics -->
      <div class="section">
        <h2 class="section-title">ğŸ”§ Metrik Performa Kendaraan</h2>
        <p style="margin-bottom: 16px; color: #666; font-size: 14px;">
          Perhitungan keausan komponen berdasarkan kondisi berkendara (akselerasi, pengereman, elevasi, temperatur).
        </p>
        
        <div class="perf-grid">
          <div class="perf-item">
            <div class="perf-label">ğŸ› Ban Belakang (Rear Tire)</div>
            <div class="perf-value">{{ perf.s_rear_tire_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸ› Ban Depan (Front Tire)</div>
            <div class="perf-value">{{ perf.s_front_tire_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸ”´ Kampas Rem Belakang</div>
            <div class="perf-value">{{ perf.s_rear_brake_pad_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸ”´ Kampas Rem Depan</div>
            <div class="perf-value">{{ perf.s_front_brake_pad_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">â›“ï¸ Rantai / CVT</div>
            <div class="perf-value">{{ perf.s_chain_or_cvt_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸ›¢ï¸ Oli Mesin</div>
            <div class="perf-value">{{ perf.s_engine_oil_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸï¸ Odometer Mesin</div>
            <div class="perf-value">{{ perf.s_engine_km }} <span class="perf-unit">km</span></div>
          </div>
          
          <div class="perf-item">
            <div class="perf-label">ğŸ’¨ Filter Udara</div>
            <div class="perf-value">{{ perf.s_air_filter_km }} <span class="perf-unit">km equiv.</span></div>
          </div>
        </div>
      </div>
      
      <!-- Download Section -->
      <div class="section">
        <h2 class="section-title">ğŸ’¾ Download Data</h2>
        <div class="download-section">
          <p style="margin-bottom: 16px; color: #666;">
            Download data simulasi lengkap dalam format CSV.
          </p>
          <a href="{{ csv_file }}" class="btn">ğŸ“¥ Download CSV Data</a>
          <span style="color: #666; font-size: 14px;">{{ csv_name }}</span>
        </div>
      </div>
      
      <!-- Plots -->
      <div class="section">
        <h2 class="section-title">ğŸ“ˆ Visualisasi Data <span class="new-badge">6 PLOTS</span></h2>
        
        <!-- Plot 1-3: Original -->
        <div class="plot-container">
          <h4>âš¡ Profil Kecepatan vs Waktu</h4>
          <img src="{{ img1 }}" alt="Speed vs Time" />
          <p style="margin-top: 8px; font-size: 13px; color: #666;">
            Titik merah = pengereman. Menampilkan perubahan kecepatan sepanjang perjalanan.
          </p>
        </div>
        
        <div class="plot-container">
          <h4>â›°ï¸ Profil Elevasi vs Jarak</h4>
          <img src="{{ img2 }}" alt="Elevation vs Distance" />
          <p style="margin-top: 8px; font-size: 13px; color: #666;">
            Tanjakan dan turunan mempengaruhi konsumsi bahan bakar dan keausan komponen.
          </p>
        </div>
        
        <div class="plot-container">
          <h4>ğŸ Profil Kecepatan vs Jarak</h4>
          <img src="{{ img3 }}" alt="Speed vs Distance" />
          <p style="margin-top: 8px; color: #666;">
            Hubungan kecepatan dengan jarak tempuh. Titik merah = pengereman aktif.
          </p>
        </div>
        
        <!-- Plot 4-6: NEW! -->
        <div class="plot-container" style="border: 3px solid #e74c3c;">
          <h4>ğŸ“Š Perbandingan: Jarak Real vs Keausan Komponen <span class="new-badge">NEW!</span></h4>
          <img src="{{ img4 }}" alt="Component Comparison" />
          <p style="margin-top: 8px; font-size: 13px; color: #666;">
            Bar chart menunjukkan keausan setiap komponen dibandingkan jarak tempuh aktual.
            <strong>Nilai positif (+)</strong> = keausan lebih besar dari jarak (stressed/high load).
            <strong>Nilai nol</strong> = sama dengan jarak (normal wear).
            Ban belakang & chain/CVT biasanya lebih tinggi (drive force), oli tinggi jika suhu tinggi.
          </p>
        </div>
        
        <div class="plot-container" style="border: 3px solid #e74c3c;">
          <h4>ğŸŒ¡ï¸ Analisis: Suhu Mesin vs Keausan Oli <span class="new-badge">NEW!</span></h4>
          <img src="{{ img5 }}" alt="Temperature vs Oil" />
          <p style="margin-top: 8px; font-size: 13px; color: #666;">
            <strong>Grafik kiri:</strong> Efek exponential suhu terhadap keausan oli (90Â°C = 1.0x, 100Â°C = 1.65x, 110Â°C = 2.72x).
            <strong>Grafik kanan:</strong> Keausan oli pada berbagai suhu. Garis hijau = oli Anda, garis biru = jarak real.
            Suhu tinggi = keausan oli jauh lebih cepat!
          </p>
        </div>
        
        <div class="plot-container" style="border: 3px solid #e74c3c;">
          <h4>ğŸ”´ Analisis: Distribusi Pengereman <span class="new-badge">NEW!</span></h4>
          <img src="{{ img6 }}" alt="Brake Distribution" />
          <p style="margin-top: 8px; font-size: 13px; color: #666;">
            <strong>Diagram kiri (pie):</strong> Persentase beban pengereman (front vs rear). Typical motor: 60-70% depan, 30-40% belakang.
            <strong>Diagram kanan (bar):</strong> Perbandingan keausan kampas rem. Front brake biasanya lebih tinggi karena menerima beban lebih besar.
          </p>
        </div>
      </div>
      
      <!-- Simulation Parameters -->
      <div class="section">
        <h2 class="section-title">âš™ï¸ Parameter Simulasi</h2>
        <div style="background: #f8f9fa; padding: 20px; border-radius: 12px;">
          <table class="params-table">
            <tr>
              <td>Kecepatan Maksimal</td>
              <td>{{ params.max_speed }} km/h</td>
            </tr>
            <tr>
              <td>Kecepatan Minimal</td>
              <td>{{ params.min_speed }} km/h</td>
            </tr>
            <tr>
              <td>Kecepatan Rata-rata Target</td>
              <td>{{ params.avg_speed }} km/h</td>
            </tr>
            <tr>
              <td>ğŸ†• Target Waktu Tempuh</td>
              <td>
                <strong style="color: #e74c3c;">{{ params.target_time_minutes }}</strong>
                {% if params.target_time_minutes != 'Not set' %}
                  menit ({{ (params.target_time_minutes / 60)|round(1) }} jam)
                {% endif %}
              </td>
            </tr>
            <tr>
              <td>Kepadatan Lalu Lintas</td>
              <td>
                {{ params.traffic_density|title }}
                {% if params.traffic_density == 'low' %}
                  <span class="badge" style="background: #4caf50;">Rendah</span>
                {% elif params.traffic_density == 'medium' %}
                  <span class="badge" style="background: #ff9800;">Sedang</span>
                {% else %}
                  <span class="badge" style="background: #f44336;">Tinggi</span>
                {% endif %}
              </td>
            </tr>
            <tr>
              <td>Massa Total</td>
              <td>{{ params.mass }} kg</td>
            </tr>
            <tr>
              <td>Wheelbase</td>
              <td>{{ params.wheelbase }} meter</td>
            </tr>
            <tr>
              <td>Suhu Mesin</td>
              <td>{{ params.temp_machine }} Â°C</td>
            </tr>
          </table>
        </div>
      </div>
      
      <!-- Back Link -->
      <div class="back-link">
        <a href="{{ url_for('index') }}" class="btn btn-secondary">
          ğŸ”„ Simulasi Rute Baru
        </a>
      </div>
      
    </div>
  </div>
</body>
</html>